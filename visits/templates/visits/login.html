{# visits/templates/visits/login.html #}
{% extends "visits/base.html" %}
{% load static %}

{% block title %}تسجيل الدخول{% endblock %}
{% block subtitle %}تسجيل دخول المشرف{% endblock %}

{# ✅ لا نعرض Hero ولا رسائل base #}
{% block hero %}{% endblock %}
{% block page_messages %}{% endblock %}

{% block extra_css %}
<style>
  /* ✅ إخفاء الهيدر فقط في صفحة الدخول */
  header.topbar{ display:none !important; }

  /* ✅ توحيد الخط + تخفيف السمك داخل صفحة الدخول فقط */
  .login-wrap, .login-wrap *{
    font-family: "Cairo","Tajawal",system-ui,-apple-system,"Segoe UI",Tahoma,Arial,sans-serif !important;
    font-weight: 500; /* الأساس */
  }

  /* تحسين تموضع الصفحة بعد إخفاء الهيدر */
  .page{ margin-top: 26px; }
  .shell{ padding: 26px; }

  /* Login Card (هادئة وكلاسيكية) */
  .login-wrap{
    min-height: calc(100vh - 180px);
    display:grid;
    place-items:center;
    padding: 14px 0 8px;
  }

  .login-card{
    width:min(520px, 100%);
    border-radius: 22px;
    background: rgba(255,255,255,.86);
    border: 1px solid rgba(148,163,184,.26);
    box-shadow: 0 24px 60px rgba(2,6,23,.10);
    backdrop-filter: blur(10px);
    overflow:hidden;
  }

  .login-head{
    padding: 18px 18px 14px;
    border-bottom: 1px solid rgba(226,232,240,.85);
    background: linear-gradient(135deg, rgba(96,165,250,.12), rgba(34,197,94,.08));
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }

  .login-brand{
    display:flex;
    align-items:center;
    gap:10px;
  }
  .login-brand .mark{
    width:44px; height:44px;
    border-radius: 16px;
    display:grid; place-items:center;
    font-weight: 700; /* كان 900 */
    background: rgba(37,99,235,.10);
    border:1px solid rgba(37,99,235,.18);
    color: #1d4ed8;
    user-select:none;
  }
  .login-brand .txt{ line-height:1.2; }
  .login-brand .txt b{
    display:block;
    font-size:14px;
    font-weight: 650; /* كان 900 */
  }
  .login-brand .txt small{
    display:block;
    font-size:12px;
    color: var(--mut);
    margin-top:2px;
    font-weight: 500;
  }

  .status-pill{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:8px 12px;
    border-radius:999px;
    background: rgba(255,255,255,.80);
    border:1px solid rgba(226,232,240,.85);
    font-size:12px;
    color: var(--text);
    white-space:nowrap;
    font-weight: 600; /* إضافة */
  }
  .status-pill i{
    width:10px; height:10px; border-radius:999px;
    background: var(--ok);
    box-shadow: 0 0 0 4px rgba(34,197,94,.16);
    display:inline-block;
  }

  .login-body{ padding: 18px; }

  .login-title{
    margin: 2px 0 2px;
    font-size: 18px;
    font-weight: 700; /* كان 900 */
    letter-spacing: .2px;
  }
  .login-sub{
    margin: 0 0 14px;
    color: var(--mut);
    font-size: 13px;
    line-height: 1.9;
    font-weight: 500;
  }

  .field{ margin: 12px 0; }
  .label{
    font-size: 12.5px;
    color: var(--mut);
    margin: 0 2px 6px;
    font-weight: 650; /* كان 800 */
  }

  .control{
    position:relative;
    display:flex;
    align-items:center;
    gap:10px;
    padding: 12px 12px;
    border-radius: 16px;
    background: rgba(248,250,252,.92);
    border: 1px solid rgba(226,232,240,.95);
    transition: .15s ease;
  }
  .control:focus-within{
    border-color: rgba(37,99,235,.30); /* أخف */
    box-shadow: 0 0 0 6px rgba(37,99,235,.08); /* أخف */
    background:#fff;
  }

  .control input{
    width:100%;
    border:0;
    outline:0;
    background:transparent;
    font: inherit;
    padding:0;
    color: var(--text);
    font-weight: 600; /* كان 700 */
    letter-spacing: .2px;
  }
  .hint{
    margin-top:6px;
    display:flex;
    justify-content:space-between;
    gap:10px;
    color: var(--mut);
    font-size: 12px;
    font-weight: 500;
  }
  .hint span{ opacity:.95; }

  .actions{
    margin-top: 14px;
    display:flex;
    gap:10px;
  }
  .btn{
    height: 44px;
    border-radius: 14px;
    padding: 0 16px;
    border: 1px solid rgba(226,232,240,.95);
    background:#fff;
    font-weight: 650; /* كان 900 */
    cursor:pointer;
    transition: .15s ease;
  }
  .btn:hover{ transform: translateY(-1px); }
  .btn.primary{
    flex:1;
    border: 0;
    background: linear-gradient(135deg, rgba(37,99,235,.92), rgba(59,130,246,.85));
    color:#fff;
    box-shadow: 0 16px 34px rgba(37,99,235,.18);
    font-weight: 700; /* تأكيد */
  }

  .login-foot{
    padding: 12px 18px;
    border-top: 1px solid rgba(226,232,240,.85);
    color: var(--mut);
    font-size: 12px;
    display:flex;
    justify-content:space-between;
    gap:10px;
    flex-wrap:wrap;
    font-weight: 500;
  }

  /* موبايل */
  @media (max-width: 520px){
    .shell{ padding: 16px; }
    .login-body{ padding: 16px; }
  }
</style>
{% endblock %}

{% block content %}
<div class="login-wrap">

  <div class="login-card">

    <div class="login-head">
      <div class="login-brand">
        <div class="mark">VP</div>
        <div class="txt">
          <b>منصة الزيارات</b>
          <small>بوابة المشرف</small>
        </div>
      </div>

      <div class="status-pill"><i></i> يعمل الآن</div>
    </div>

    <div class="login-body">
      <div class="login-title">تسجيل الدخول</div>
      <div class="login-sub">ادخل رقم الهوية + آخر 4 أرقام من الجوال المسجل في النظام.</div>

      {# ✅ رسائل الدخول فقط (وليس رسائل base) #}
      {% if messages %}
        <div class="msgs" style="margin:0 0 10px;">
          {% for message in messages %}
            <div class="msg {{ message.tags }}">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}

      <form method="post" novalidate>
        {% csrf_token %}

        <div class="field">
          <div class="label">رقم الهوية</div>
          <div class="control">
            <input name="national_id" inputmode="numeric" autocomplete="username"
                   maxlength="10" placeholder="مثال: 1020103717" required>
          </div>
          <div class="hint">
            <span>10 أرقام فقط</span>
            <span>تحقق مباشر</span>
          </div>
        </div>

        <div class="field">
          <div class="label">آخر 4 أرقام من الجوال</div>
          <div class="control">
            <input name="phone_last4" inputmode="numeric" autocomplete="current-password"
                   maxlength="4" placeholder="مثال: 3717" required>
          </div>
          <div class="hint">
            <span>4 أرقام فقط</span>
            <span>تحقق مباشر</span>
          </div>
        </div>

        <div class="actions">
          <button type="reset" class="btn">مسح</button>
          <button type="submit" class="btn primary">دخول</button>
        </div>
      </form>
    </div>

    <div class="login-foot">
      <div>© منصة خطة الزيارات — جميع الحقوق محفوظة</div>
      <div>الإصدار: 2026</div>
    </div>

  </div>
</div>
{% endblock %}
